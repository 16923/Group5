#This is the code and data for chi-square test on comorbidities.

#early onset
n1=1165
n2=1397
n3=2562
pv <- c()

#401
a=0.231
b=0.29
c=0.237

#272
a=0.082
b=0.191
c=0.124

#
a=0.049
b=0.096
c=0.066

a=0.084
b=0.143
c=0.103
#
a=0.039
b=0.106
c=0.066
#272
a=0.066
b=0.125
c=0.087
#272
a=0.118
b=0.082
c=0.091
#272
a=0.118
b=0.087
c=0.092
#272
a=0.018
b=0.065
c=0.038
#272
a=0.039
b=0.101
c=0.064
#272
a=0.124
b=0.081
c=0.047
#272
a=0.0009
b=0.065
c=0.034
#272
a=0.031
b=0.071
c=0.046
#272
a=0.037
b=0.069
c=0.048
#272
a=0.055
b=0.045
c=0.046
#272
a=0.082
b=0.051
c=0.06
#272
a=0.055
b=0.082
c=0.062
#272
a=0.047
b=0.062
c=0.05
#272
a=0.053
b=0.027
c=0.037
#272
a=0.052
b=0.045
c=0.044
#272
a=0.037
b=0.042
c=0.039
#272
a=0.033
b=0.052
c=0.044

#late onset
n1=4221
n2=4981
n3=9202
pv <- c()

#401
a=0.247
b=0.254
c=0.251

#272
a=0.088
b=0.177
c=0.136

#
a=0.039
b=0.01
c=0.072

a=0.089
b=0.113
c=0.102
#
a=0.043
b=0.107
c=0.078
#272
a=0.072
b=0.109
c=0.092
#272
a=0.142
b=0.065
c=0.01
#272
a=0.113
b=0.053
c=0.081
#272
a=0.014
b=0.052
c=0.035
#272
a=0.064
b=0.104
c=0.085
#272
a=0.025
b=0.075
c=0.052
#272
a=0.014
b=0.045
c=0.031
#272
a=0.028
b=0.074
c=0.053
#272
a=0.069
b=0.092
c=0.081
#272
a=0.069
b=0.044
c=0.056
#272
a=0.083
b=0.047
c=0.064
#272
a=0.049
b=0.072
c=0.062
#272
a=0.069
b=0.051
c=0.059
#272
a=0.051
b=0.023
c=0.036
#272
a=0.057
b=0.041
c=0.049
#272
a=0.050
b=0.05
c=0.050
#272
a=0.032
b=0.058
c=0.046

library(glmnet)

#early onset
n1=1165
n2=1397
n3=2562
pv <- c()

#401
a=0.231
b=0.29
c=0.237



data <- matrix(c(n1*a,n2*b,n3*c,n1*(1-a),n2*(1-b),n3*(1-c)),nrow=2,dimnames=list(c("Yes","No"),c("With ICD","No ICD","Early Onset Merged")))
chi.result <- chisq.test(data)
x <-chi.result$p.value
x

pv <- append(pv,x)


pv

